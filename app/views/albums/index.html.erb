<div class="main-container">

  <div class="container albums-index-container">
    <h3>Découvrez les BD <br>autour de chez vous</h3>
    <div class='row'>
      <% albums_sorted = @albums.sort_by { |album| album.comic.title.downcase } %>
      <% albums_sorted.each do |album| %>
        <% if album.available == true %>
          <% if album.rentals.length == 0 %>
            <div class="col-xs-12 col-sm-12 col-md-6 col-lg-6">
              <div class="card-container">
                <div class="card index-album-card-body" style="background-image: url(<%= album.comic.artwork %>);">
                  <%= link_to 'Info', album_path(album) %>
                  <div class="card-hover">
                    <div class="index-album-card-description">
                      <h5><%= album.comic.title %></h5>
                      <p>Localisation : <%= album.user.address %></p>
                    </div>
                  </div>
                </div>
                <div class="index-album-card-footer">
                  <div class='index-contact-btn'>
                    <button type="button" class="btn btn-success" data-toggle="modal" data-target="#demandeEmpruntModal"><span>Contacter</span> </button>
                    <div class="modal fade" id="demandeEmpruntModal" tabindex="-1" role="dialog" aria-labelledby="demandeEmpruntModalLabel" aria-hidden="true">
                    <%= render 'modal', album: album %>
                    </div>
                  </div>
                  <div class="album-rental-status">
                    <i class="fas fa-square" style=" color: green;"></i>
                  </div>
                </div>
              </div>
            </div>
          <%else %>
            <div class="col-xs-12 col-sm-7 col-md-4 col-lg-3">
              <div class="index-album-card" style="background-image: url(<%= album.comic.artwork %>); ">
                <div class="index-album-card-description">
                  <p><strong><%= album.comic.title %></strong></p>
                  <p>Localisation : <%= album.user.address %></p>
                </div>
                <div class="album-rental-status">
                  <i class="fas fa-square" style=" color: red;"></i>
                </div>
                <div class='index-contact-btn'>
                  <button type="button" class="btn btn-success" data-toggle="modal" data-target="#demandeEmpruntModal">Contacter le propriétaire </button>
                  <div class="modal fade" id="demandeEmpruntModal" tabindex="-1" role="dialog" aria-labelledby="demandeEmpruntModalLabel" aria-hidden="true">
                  <%= render 'modal', album: album %>
                  </div>
                </div>
                <%= link_to 'Info', album_path(album) %>
              </div>
            </div>
          <%end%>
        <% end %>
      <% end %>
    </div>
  </div>

  <div id="map" style="width: 140%;
  height: calc(100vh - 70px);"
  data-markers="<%= @markers.to_json %>"
  data-mapbox-api-key="<%= ENV['MAPBOX_API_KEY'] %>">
  </div>

</div>
